# Task #162: timeouts.delete

## Summary
Updated the `timeouts.delete` field default value to "60m" in the `timeouts` variable to match the provider's default timeout configuration. This is a meta-argument handled by the parent module's `azapi_resource` block, not a shadow module implementation.

## Create Phase Verification

**Pattern:** Meta-block (N/A for Azure API)

From `resourceOrchestratedVirtualMachineScaleSet()` schema:

```go
Timeouts: &pluginsdk.ResourceTimeout{
    Create: pluginsdk.DefaultTimeout(60 * time.Minute),
    Read:   pluginsdk.DefaultTimeout(5 * time.Minute),
    Update: pluginsdk.DefaultTimeout(60 * time.Minute),
    Delete: pluginsdk.DefaultTimeout(60 * time.Minute),
},
```

**Evidence:**
- Default value: **60 minutes**
- This is a resource-level meta-argument, not a request body property
- The timeout controls how long the Delete operation can run before timing out

**Classification:** This is a Terraform provider meta-argument that configures operation timeout behavior. It is NOT part of the Azure API request body.

## Assignment Path Verification

N/A - This is a Terraform meta-argument, not an Azure API property.

## Provider Schema

From `internal/services/compute/orchestrated_virtual_machine_scale_set_resource.go`:

```go
func resourceOrchestratedVirtualMachineScaleSet() *pluginsdk.Resource {
    return &pluginsdk.Resource{
        Create: resourceOrchestratedVirtualMachineScaleSetCreate,
        Read:   resourceOrchestratedVirtualMachineScaleSetRead,
        Update: resourceOrchestratedVirtualMachineScaleSetUpdate,
        Delete: resourceOrchestratedVirtualMachineScaleSetDelete,

        Timeouts: &pluginsdk.ResourceTimeout{
            Create: pluginsdk.DefaultTimeout(60 * time.Minute),
            Read:   pluginsdk.DefaultTimeout(5 * time.Minute),
            Update: pluginsdk.DefaultTimeout(60 * time.Minute),
            Delete: pluginsdk.DefaultTimeout(60 * time.Minute),  // <- 60 minutes default
        },
        // ...
    }
}
```

The `Delete` timeout is set to `60 * time.Minute` which equals **60 minutes**.

## Azure API Schema

N/A - The `timeouts` block is not part of the Azure API. It is a Terraform-specific configuration.

## Mapping

- `timeouts.delete` (Terraform meta-argument) → No Azure API equivalent
- Converted duration: `60 * time.Minute` → `"60m"`

## Implementation

Updated `variables.tf` (line 1549):

```hcl
variable "timeouts" {
  type = object({
    create = optional(string, "60m")
    delete = optional(string, "60m")  # <- Added default from provider
    read   = optional(string)
    update = optional(string)
  })
  default     = null
  description = <<-EOT
 - `create` - (Optional) Specifies the timeout for create operations. Defaults to 60 minutes.
 - `delete` - (Optional) Specifies the timeout for delete operations. Defaults to 60 minutes.
 - `read` - (Optional) Specifies the timeout for read operations. Defaults to 5 minutes.
 - `update` - (Optional) Specifies the timeout for update operations. Defaults to 60 minutes.
EOT
}
```

**Changes:**
- Line 1549: Changed `delete = optional(string)` to `delete = optional(string, "60m")`
- Description already documented the correct default (no changes needed)

## Special Handling

**Timeouts Meta-Argument:**
- ✅ No shadow module implementation required
- ✅ The parent module's `azapi_resource` block handles timeouts directly
- ✅ Variable default updated to match provider default

**Shadow Module:**
- No changes required in `migrate_main.tf`, `migrate_variables.tf`, `migrate_outputs.tf`, or `migrate_validation.tf`
- The timeouts are consumed directly by the parent module

## Critical Review & Edge Cases

**Timeout Behavior:**
1. **When null:** Uses the default value of "60m"
2. **When set:** Overrides the default with user-specified duration
3. **Format:** Must be a valid Go duration string (e.g., "60m", "1h", "90m")
4. **Effect:** Controls maximum time allowed for delete operations before timeout error

**Edge Cases:**
- Very short timeouts (e.g., "1m") may cause premature failures for slow delete operations
- Very long timeouts (e.g., "10h") may delay error detection
- The Azure API has its own timeout mechanisms independent of Terraform

**Idempotency:** N/A - This is a client-side timeout configuration, not a resource property

**Safe References:** N/A - This is a scalar string value with no nested references

## Checklist

- ✅ Property in correct location (variables.tf)
- ✅ Default value extracted from provider source code
- ✅ Default value correctly converted (60 * time.Minute → "60m")
- ✅ Variable description already correct (no changes needed)
- ✅ No shadow module changes required (meta-argument)
- ✅ Provider schema evidence documented
- ✅ Critical review completed
- ✅ Edge case analysis included
- ✅ Proof document created
- ✅ Track.md ready to be updated

---

## ✅ CHECKER VALIDATION - APPROVED

**Checked by:** Checker Agent
**Date:** 2025-12-12
**Task:** #162 - timeouts.delete

### Validation Results

✅ **Timeouts Meta-Argument:** Correctly identified as Terraform meta-argument, not Azure API property
✅ **Provider Schema Evidence:** Correct evidence from `resourceOrchestratedVirtualMachineScaleSet()` showing `Delete: pluginsdk.DefaultTimeout(60 * time.Minute)`
✅ **Variable Default Updated:** Line 1549 in `variables.tf` correctly shows `delete = optional(string, "60m")`
✅ **Description Correct:** Line 1556 correctly documents "Defaults to 60 minutes"
✅ **Type Conversion:** Correctly converted `60 * time.Minute` → `"60m"`
✅ **No Shadow Module Changes:** Correctly stated no changes required in migrate_* files (parent module handles timeouts)
✅ **Deferred Work Completion:** No deferred work for this task (verified following.md)
✅ **Deferred Work Recording:** No deferrals made (N/A for timeout tasks)
✅ **Edge Cases:** N/A for meta-argument (timeout is client-side configuration)

### Compliance Statement

This implementation EXACTLY follows the timeouts.md override rules as required by executor.md. The timeout default value was correctly extracted from provider source code, converted to proper string format, and applied to the variable definition. No shadow module implementation is required as timeouts are meta-arguments handled by the parent module's azapi_resource block.

**Status:** APPROVED ✅

---
